<%- include('../partials/html-head') %>
<link rel="stylesheet" href="/stylesheets/style.css" />
<link rel="stylesheet" href="/stylesheets/albums/show.css" />

<%- include('../partials/nav') %>

<p>-UpBeat brought to you by <%= album.owner.name %>-</p>
<main>
<h1>"<%= album.title %>"</h1>
<section id="album-details">
    <div>Artist -----> <%= album.artist %></div>
    <div>Release Year -----> <%= album.year %></div>
    <div>Record Label -----> <%= album.recordLabel %></div>
    <div>Favorite Song -----> <%= album.favTrack %></div>
</section>

<section id="edit-option">
    <% if (album.owner.equals(user?.profile._id)) { %>
    <form class="edit-form" action="/albums/<%= album._id %>/edit" method="GET">
      <button class="edit-alb-btn" type="submit">Edit Album</button>
    </form>
  <% } %>
</section>
</main>

<section id="reviews">
  <% if (album.reviews.length) { %>
    <table>
      <thead>
        <tr>
          <th>Author</th>
          <th>Date</th>
          <th>Rating</th>
          <th>Review</th>
        </tr>
      </thead>
      <tbody>
        <% album.reviews.forEach(function(review) { %>
          <tr>
            <td><%= review.owner.name %></td>
            <td><%= review.createdAt.toLocaleDateString() %></td>
            <td><%= review.rating %></td>
            <td><%= review.content %></td>
            <% if (review.owner.equals(user?.profile._id)) { %>
            <td><form action="/albums/<%= album._id %>/reviews/<%= review._id %>" method="GET">
              <button class="btn" type="submit">Edit</button>
            </form></td>
            <td><form action="/albums/<%= album._id %>/reviews/<%= review._id %>?_method=DELETE" method="POST">
              <button class="delete-review-btn" type="sumbit">X</button>
            </form></td>
          </tr>
          <% } %>
        <% }) %>
      </tbody>
    </table>
  <% } else { %>
    <h3>No Reviews Yet</h3>
  <% } %>

  <section id="review-option">
    <form action="/albums/<%= album._id %>/reviews" method="GET">
    <button class="add-review-btn" type="submit">
      Add Review
    </button>
    </form>
</section>



</section>






<%- include('../partials/footer') %>